<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
  <head>
    <title>Class: AbtPackage</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />

    <script language="JavaScript" type="text/javascript">
    // <![CDATA[

        function toggleSource( id )
        {
          var elem
          var link

          if( document.getElementById )
          {
            elem = document.getElementById( id )
            link = document.getElementById( "l_" + id )
          }
          else if ( document.all )
          {
            elem = eval( "document.all." + id )
            link = eval( "document.all.l_" + id )
          }
          else
            return false;

          if( elem.style.display == "block" )
          {
            elem.style.display = "none"
            link.innerHTML = "show source"
          }
          else
          {
            elem.style.display = "block"
            link.innerHTML = "hide source"
          }
        }

        function openCode( url )
        {
          window.open( url, "SOURCE_CODE", "width=400,height=400,scrollbars=yes" )
        }
      // ]]>
    </script>
  </head>

  <body>
  <table width="100%" border='0' cellpadding='0' cellspacing='0' class='banner'><tr>
  <td class="file-title"><span class="file-title-prefix">Class</span><br />AbtPackage</td>
  <td align="right">
    <table cellspacing=0 cellpadding=2>
      <tr valign="top">
        <td>In:</td>
        <td>
<a href="../files/AbtPackage_rb.html">AbtPackage.rb</a>
        </td>
      </tr>
    <tr>
      <td>Parent:</td>
      <td>
Object
     </td>
   </tr>
         </table>
        </td>
        </tr>
      </table>
 <!-- banner header -->

  <div id="bodyContent">
      <div id="content">
  <table cellpadding='0' cellspacing='0' border='0' width="100%"><tr><td align="center">
    <map id="map" name="map">
  <area shape="RECT" coords="27,50,115,98"      href="AbtPackage.html" alt="AbtPackage">
</map>
<img src="../dot/f_3.png" usemap="#map" border=0 alt="TopLevel">
  </td></tr></table>

  <div class="description"><p>
AbtPackage.rb
</p>
<p>
<a href="AbtPackage.html">AbtPackage</a> class provides an interface to <a
href="AbtPackage.html">AbtPackage</a> creation within AbTLinux. By
inheriting from this class (class Fortune &lt; <a
href="AbtPackage.html">AbtPackage</a>) one picks up all supported standard
functions for the abt <a href="AbtPackage.html">AbtPackage</a> manager to
make use of the new <a href="AbtPackage.html">AbtPackage</a>.
</p>
<p>
Created by Eric D. Schabell &lt;erics@abtlinux.org&gt; Copyright 2006, GPL.
</p>
<p>
This file is part of AbTLinux.
</p>
<p>
AbTLinux is free software; you can redistribute it and/or modify it under
the terms of the GNU General Public License as published by the Free
Software Foundation; either version 2 of the License, or (at your option)
any later version.
</p>
<p>
AbTLinux is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE. See the GNU General Public License for more
details.
</p>
<p>
You should have received a copy of the GNU General Public License along
with AbTLinux; if not, write to the Free Software Foundation, Inc., 51
Franklin St, Fifth Floor, Boston, MA 02110-1301 USA
</p>
</div>



  <div class="sectiontitle">Methods</div>
  <ul>
  <li><a href="#M000028">build</a></li>
  <li><a href="#M000027">configure</a></li>
  <li><a href="#M000025">details</a></li>
  <li><a href="#M000030">install</a></li>
  <li><a href="#M000024">new</a></li>
  <li><a href="#M000031">post</a></li>
  <li><a href="#M000026">pre</a></li>
  <li><a href="#M000029">preinstall</a></li>
  <li><a href="#M000032">removeBuildSources</a></li>
  <li><a href="#M000023">unpackSources</a></li>
  </ul>





  <div class="sectiontitle">Attributes</div>
  <table border='0' cellpadding='5'>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>dependsOn</td>
    <td class='attr-desc'>
list of dependsOn (DO) related package dependencies.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>description</td>
    <td class='attr-desc'>
the package description.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>execName</td>
    <td class='attr-desc'>
the executable name for the package.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>hashCheck</td>
    <td class='attr-desc'>
security hash value of package sources.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>homepage</td>
    <td class='attr-desc'>
the packages homepage.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>licence</td>
    <td class='attr-desc'>
type of license this package has.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>mirrorPath</td>
    <td class='attr-desc'>
available mirrors for this package.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>name</td>
    <td class='attr-desc'>
the name of the package.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>optionalDO</td>
    <td class='attr-desc'>
list of optional reliesOn (oRO) related package dependencies.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>optionalRO</td>
    <td class='attr-desc'>
list of optional dependsOn (oDO) related package dependencies.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>patches</td>
    <td class='attr-desc'>
list of available patches for this package.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>patchesHashCheck</td>
    <td class='attr-desc'>
security hash value of this packages patches.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>reliesOn</td>
    <td class='attr-desc'>
list of reliesOn (RO) related package dependencies.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>srcDir</td>
    <td class='attr-desc'>
the source directory for the package.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>srcUrl</td>
    <td class='attr-desc'>
the URL where this packages sources can be obtained.

</td>
  </tr>
  <tr valign='top'>
    <td class='attr-rw'>
[R]
    </td>
    <td class='attr-name'>version</td>
    <td class='attr-desc'>
the package version number.

</td>
  </tr>
  </table>

<div class="sectiontitle">Public Class methods</div>
<div class="method">
  <div class="title">
    <a name="M000024"></a><b>new</b>( data )
  </div>
  <div class="description">
  <p>
Constructor for an <a href="AbtPackage.html">AbtPackage</a>, requires all
the packge details.
</p>
<p>
<b>PARAM</b> <em>Hash</em> - hash containing all package data.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000024_source')" id="l_M000024_source">show source</a> ]</p>
  <div id="M000024_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 150</span>
150:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>( <span class="ruby-identifier">data</span> )
151:     <span class="ruby-ivar">@name</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'name'</span>]
152:     <span class="ruby-ivar">@execName</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'execName'</span>]
153:     <span class="ruby-ivar">@version</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'version'</span>]
154:     <span class="ruby-ivar">@srcDir</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'srcDir'</span>]
155:     <span class="ruby-ivar">@homepage</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'homepage'</span>]
156:     <span class="ruby-ivar">@srcUrl</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'srcUrl'</span>]
157:     <span class="ruby-ivar">@dependsOn</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'dependsOn'</span>]
158:     <span class="ruby-ivar">@reliesOn</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'reliesOn'</span>]
159:     <span class="ruby-ivar">@optionalDO</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'optionalDO'</span>]
160:     <span class="ruby-ivar">@optionalRO</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'optionalRO'</span>]
161:     <span class="ruby-ivar">@hashCheck</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'hashCheck'</span>]
162:     <span class="ruby-ivar">@patches</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'patches'</span>]
163:     <span class="ruby-ivar">@patchesHashCheck</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'patchesHashCheck'</span>]
164:     <span class="ruby-ivar">@mirrorPath</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'mirrorPath'</span>]
165:     <span class="ruby-ivar">@license</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'license'</span>]
166:     <span class="ruby-ivar">@description</span> = <span class="ruby-identifier">data</span>[<span class="ruby-value str">'description'</span>]
167:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Public Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000028"></a><b>build</b>()
  </div>
  <div class="description">
  <p>
Here is where the actual builing of the software starts, for example
running &#8216;make&#8217;.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000028_source')" id="l_M000028_source">show source</a> ]</p>
  <div id="M000028_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 247</span>
247:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">build</span>
248:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000027"></a><b>configure</b>()
  </div>
  <div class="description">
  <p>
Here we manage the ./configure step (or equivalent). We need to give
./configure (or autogen.sh, or whatever) the correct options so files are
to be placed later in the right directories, so doc files and man pages are
all in the same common location, etc. Don&#8216;t forget too that
it&#8217;s here where we interact with the user in case there are optionnal
dependencies.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000027_source')" id="l_M000027_source">show source</a> ]</p>
  <div id="M000027_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 231</span>
231:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">configure</span>
232:                 <span class="ruby-identifier">require</span> <span class="ruby-value str">'open3'</span>
233:                 <span class="ruby-identifier">buildSite</span> = <span class="ruby-node">&quot;#{$BUILD_LOCATION}/#{@srcDir}&quot;</span> 
234: 
235:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-identifier">system</span>( <span class="ruby-node">&quot;cd #{buildSite}; make ./configure --prefix=#{$defaultPrefix}&quot;</span> ) )
236:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
237:                 <span class="ruby-keyword kw">end</span>
238: 
239:                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
240:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000025"></a><b>details</b>()
  </div>
  <div class="description">
  <p>
Provides all the data needed for this <a
href="AbtPackage.html">AbtPackage</a>.
</p>
<p>
<b>RETURNS:</b> <em>hash</em> - Contains all <a
href="AbtPackage.html">AbtPackage</a> attributes (constants).
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000025_source')" id="l_M000025_source">show source</a> ]</p>
  <div id="M000025_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 174</span>
174:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">details</span>
175:                 <span class="ruby-keyword kw">return</span> {
176:                         <span class="ruby-value str">&quot;Package name&quot;</span>                       =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@name</span>,
177:                         <span class="ruby-value str">&quot;Executable&quot;</span>                         =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@execName</span>,
178:                         <span class="ruby-value str">&quot;Version&quot;</span>                                            =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@version</span>,
179:                         <span class="ruby-value str">&quot;Source location&quot;</span>            =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@srcDir</span>,
180:                         <span class="ruby-value str">&quot;Homepage&quot;</span>                                   =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@homepage</span>,
181:                         <span class="ruby-value str">&quot;Source uri&quot;</span>                         =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@srcUrl</span>,
182:                         <span class="ruby-value str">&quot;Depends On&quot;</span>                         =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@dependsOn</span>,
183:                         <span class="ruby-value str">&quot;Relies On&quot;</span>                                  =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@reliesOn</span>,
184:                         <span class="ruby-value str">&quot;Optional DO&quot;</span>                                =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@optionalDO</span>,
185:                         <span class="ruby-value str">&quot;Optional RO&quot;</span>                                =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@optionalRO</span>,
186:                         <span class="ruby-value str">&quot;Security hash&quot;</span>                      =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@hashCheck</span>,
187:                         <span class="ruby-value str">&quot;Patches&quot;</span>                                            =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@patches</span>,
188:                         <span class="ruby-value str">&quot;Patches hash&quot;</span>                       =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@patchesHashCheck</span>,
189:                         <span class="ruby-value str">&quot;Mirror&quot;</span>                                             =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@mirrorPath</span>,
190:                         <span class="ruby-value str">&quot;License&quot;</span>                                            =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@license</span>,
191:                         <span class="ruby-value str">&quot;Description&quot;</span>                                =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@description</span>
192:                 }
193:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000030"></a><b>install</b>()
  </div>
  <div class="description">
  <p>
All files to be installed are installed here.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000030_source')" id="l_M000030_source">show source</a> ]</p>
  <div id="M000030_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 264</span>
264:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">install</span>
265:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000031"></a><b>post</b>()
  </div>
  <div class="description">
  <p>
Last bits of installation. adding the service for automatic start in init.d
for example.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000031_source')" id="l_M000031_source">show source</a> ]</p>
  <div id="M000031_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 272</span>
272:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">post</span>
273:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000026"></a><b>pre</b>()
  </div>
  <div class="description">
  <p>
Preliminary work will happen here such as downloading the tarball,
unpacking it, downloading and applying patches.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if completes sucessfully, otherwise
false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000026_source')" id="l_M000026_source">show source</a> ]</p>
  <div id="M000026_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 201</span>
201:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">pre</span>
202:                 <span class="ruby-identifier">downloader</span> = <span class="ruby-constant">AbtDownloadManager</span>.<span class="ruby-identifier">new</span>
203: 
204:                 <span class="ruby-comment cmt"># download sources.</span>
205:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-identifier">downloader</span>.<span class="ruby-identifier">retrievePackageSource</span>( <span class="ruby-ivar">@name</span>.<span class="ruby-identifier">downcase</span>, <span class="ruby-identifier">$SOURCES_REPOSITORY</span> ) )
206:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
207:                 <span class="ruby-keyword kw">end</span>
208: 
209:                 <span class="ruby-comment cmt"># unpack sources.</span>
210:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unpackSources</span> )
211:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
212:                 <span class="ruby-keyword kw">end</span>
213: 
214:                 <span class="ruby-comment cmt"># TODO: create_group?</span>
215:                 <span class="ruby-comment cmt"># TODO: create_user?</span>
216:                 <span class="ruby-comment cmt"># TODO: retrieve patches?</span>
217:                 <span class="ruby-comment cmt"># TODO: apply patches?</span>
218:                 
219:                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
220:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000029"></a><b>preinstall</b>()
  </div>
  <div class="description">
  <p>
Any actions needed before the installation can occur will happen here, such
as creating new user accounts, dealing with existing configuration files,
etc.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000029_source')" id="l_M000029_source">show source</a> ]</p>
  <div id="M000029_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 256</span>
256:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">preinstall</span>
257:   <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="method">
  <div class="title">
    <a name="M000032"></a><b>removeBuildSources</b>()
  </div>
  <div class="description">
  <p>
Cleans up this packages source build directory.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000032_source')" id="l_M000032_source">show source</a> ]</p>
  <div id="M000032_source" class="dyn-source">
<pre>
     <span class="ruby-comment cmt"># File AbtPackage.rb, line 280</span>
280:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">removeBuildSources</span>
281:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-identifier">$removeBuildSources</span> )
282:                         <span class="ruby-identifier">buildSourcesLocation</span> = <span class="ruby-node">&quot;#{$BUILD_LOCATION}/#{srcDir}&quot;</span>
283: 
284:                         <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>( <span class="ruby-identifier">buildSourcesLocation</span> ) )
285:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
286:                         <span class="ruby-keyword kw">end</span>
287: 
288:                         <span class="ruby-comment cmt"># TODO: system call removal?</span>
289:                         <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm_rf</span> <span class="ruby-identifier">buildSourcesLocation</span>, <span class="ruby-identifier">:verbose</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>  )
290:                                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
291:                         <span class="ruby-keyword kw">end</span>
292:                 <span class="ruby-keyword kw">end</span>
293: 
294:                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
295:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
<div class="sectiontitle">Protected Instance methods</div>
<div class="method">
  <div class="title">
    <a name="M000023"></a><b>unpackSources</b>()
  </div>
  <div class="description">
  <p>
Unpacks this packages source file into the standard build location.
</p>
<p>
<b>RETURNS:</b> <em>boolean</em> - True if the completes sucessfully,
otherwise false.
</p>
  </div>
<div class="sourcecode">
  <p class="source-link">[ <a href="javascript:toggleSource('M000023_source')" id="l_M000023_source">show source</a> ]</p>
  <div id="M000023_source" class="dyn-source">
<pre>
    <span class="ruby-comment cmt"># File AbtPackage.rb, line 39</span>
39:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">unpackSources</span>
40:                 <span class="ruby-identifier">srcFile</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>( <span class="ruby-identifier">srcUrl</span> )
41:                 <span class="ruby-identifier">sourcesToUnpack</span> = <span class="ruby-node">&quot;#{$SOURCES_REPOSITORY}/#{srcFile}&quot;</span>
42:                 <span class="ruby-identifier">unpackTool</span>      = <span class="ruby-value str">&quot;&quot;</span>
43: 
44:                 <span class="ruby-comment cmt"># check for existing file in source repo.</span>
45:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>( <span class="ruby-identifier">sourcesToUnpack</span> ) )
46:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
47:                 <span class="ruby-keyword kw">end</span> 
48: 
49:                 <span class="ruby-comment cmt"># check if possible existing sources in build directory.</span>
50:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>( <span class="ruby-node">&quot;#{$BUILD_LOCATION}/#{@srcDir}&quot;</span> ) )
51:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
52:                 <span class="ruby-keyword kw">end</span>
53: 
54:                 <span class="ruby-comment cmt"># determine which supported compression used [gz, tar, tgz, bz2, zip].</span>
55:                 <span class="ruby-identifier">compressionType</span> = <span class="ruby-identifier">srcFile</span>.<span class="ruby-identifier">split</span>( <span class="ruby-value str">'.'</span> )
56: 
57:                 <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">compressionType</span>.<span class="ruby-identifier">last</span>
58: 
59:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;gz&quot;</span>
60:                         <span class="ruby-identifier">unpackTool</span> = <span class="ruby-value str">&quot;tar xzvf&quot;</span>
61: 
62:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;tar&quot;</span>
63:                         <span class="ruby-identifier">unpackTool</span> = <span class="ruby-value str">&quot;tar xvf&quot;</span>
64: 
65:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;bz2&quot;</span>
66:                         <span class="ruby-identifier">unpackTool</span> = <span class="ruby-value str">&quot;tar xjvf&quot;</span>
67: 
68:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;tgz&quot;</span> 
69:                         <span class="ruby-identifier">unpackTool</span> = <span class="ruby-value str">&quot;tar xzvf&quot;</span>
70:                 
71:                 <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;zip&quot;</span>
72:                         <span class="ruby-identifier">unpackTool</span> = <span class="ruby-value str">&quot;unizp&quot;</span>
73: 
74:                 <span class="ruby-keyword kw">else</span>
75:                         <span class="ruby-comment cmt"># unsupported format.</span>
76:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
77:                 <span class="ruby-keyword kw">end</span>
78:                 
79:                 <span class="ruby-comment cmt"># DEBUG:</span>
80:                 <span class="ruby-comment cmt">#logger = AbtLogManager.new</span>
81:                 <span class="ruby-comment cmt">#logger.logToJournal( &quot;DEBUG: unpack tool will be '#{unpackTool}'.&quot; )</span>
82: 
83:                 <span class="ruby-comment cmt"># TODO: system call removal?</span>
84:                 <span class="ruby-keyword kw">if</span> ( <span class="ruby-operator">!</span><span class="ruby-identifier">system</span>( <span class="ruby-node">&quot;cd #{$BUILD_LOCATION}; #{unpackTool} #{sourcesToUnpack}&quot;</span> ) )
85:                         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
86:                 <span class="ruby-keyword kw">end</span>
87: 
88:                 <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">true</span>
89:         <span class="ruby-keyword kw">end</span>
</pre>
  </div>
</div>
</div>
</div>

  </div>

    </body>
</html>